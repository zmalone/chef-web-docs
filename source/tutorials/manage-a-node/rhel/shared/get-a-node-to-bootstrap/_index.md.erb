[HEADLINE] Any computer that's managed by Chef is called a _node_.

Now it's time to bring up a Red Hat Enterprise Linux 7 or CentOS 7 instance and prepare it for the bootstrap process.

[COMMENT] For this tutorial, we recommend you use CentOS. CentOS is a free computing platform that's functionally compatible with Red Hat Enterprise Linux. You can of course use Red Hat Enterprise Linux if you prefer.

[COMMENT] Although Chef supports [multiple versions of Red Hat Enterprise Linux and CentOS](https://docs.chef.io/platforms.html#chef-client-title-foundational-platforms), for this tutorial we recommend you use CentOS 7. Doing so helps ensure that the output you see matches the sample output that's shown.

In [Learn the Chef basics](/tutorials/learn-the-basics/), you installed the Chef DK on a server and configured it directly. Here you'll set up a Red Hat Enterprise Linux or CentOS server, called a _node_, and prepare your node to be configured by Chef remotely from your workstation.

[START_BOX]

## 1. Get a Red Hat Enterprise Linux 7 or CentOS 7 node to bootstrap

Like before, we suggest that you work in a disposable environment such as a Red Hat Enterprise Linux 7 or CentOS 7 virtual machine or cloud instance.

Ensure that your system:

* provides `root` or `sudo` access.
* has a resolvable IP address.
* can access the Internet.
* provides network access on ports 22 (SSH), 80 (HTTP), and 443 (HTTPS).

[COMMENT] The easiest way to get started is to use a system that can access the Internet over ports 22, 80 and 443. If your firewall or network environment doesn't provide this access, [check out this blog post](https://www.chef.io/blog/2014/10/28/working-with-chef-behind-your-firewall/) and [this video](https://youtu.be/iD859HMm9XI?list=PL11cZfNdwNyPo_EEgCGDe9mrUlMtTf361).

If you still have the system that you used in the first tutorial, _Learn the Chef basics_, you can continue to use that system for this tutorial. However, the [free trial virtual machine](/tutorials/learn-the-basics/rhel/free/) option that we provide in the first tutorial does not have a public IP address. If you used the free trial VM, you'll need to bring up your own system.

The system requirements for your node are the same as the ones you used in the first tutorial. Use these links if you need a refresher on how to bring up a node in your preferred runtime environment.

* [Amazon Web Services (step 2)](/tutorials/learn-the-basics/rhel/aws/set-up-a-machine-to-manage/#step2)
* [Microsoft Azure (step 2)](/tutorials/learn-the-basics/rhel/azure/set-up-a-machine-to-manage/#step2)
* [Google Compute Platform (step 2)](/tutorials/learn-the-basics/rhel/gcp/set-up-a-machine-to-manage/#step2)
* [Vagrant and VirtualBox (step 5)](/tutorials/learn-the-basics/rhel/virtualbox/set-up-a-machine-to-manage/#step5)
* [Bring your own system (step 1)](/tutorials/learn-the-basics/rhel/bring-your-own-system/set-up-a-machine-to-manage/#step1)

[END_BOX]

[START_BOX]

## 2. Gather some details about your machine

[COMMENT] All you need is for your system to be running &ndash; don't connect to it just yet.

Now, gather this information about your machine:

* Its hostname or public IP address.
* A user name that has root or `sudo` access and its password. If you use key-based authentication to connect to your instance, note the location of your private key file.

<% markdown do %>

If you're bootstrapping a local virtual machine, such as a Vagrant instance, you'll also need to know which [forwarded port](https://docs.vagrantup.com/v2/networking/forwarded_ports.html) Vagrant chose for routing SSH traffic. Forwarded ports enable the host (your workstation) to receive and forward network traffic to the guest (the virtual machine.)

If you're using virtualization software other than Vagrant and VirtualBox, check the documentation for that software to learn how to get the SSH connection details to the virtual machine, including the SSH forwarded port. Here's how to get the connection details for Vagrant.

<% accordion('vagrant-details', "Show details") do %>

<%= partial 'layouts/partials/vagrant_ssh_config_centos' %>

<% end %>

<% end %>

[END_BOX]

[START_BOX]

## 3. Create a test SSH connection to your node

The bootstrap process connects to your node over SSH. Now that you have the connection details, let's create a test SSH connection to your node.

You don't have to do this every time you bootstrap a node, but verifying that your node is connectable will help ensure that the bootstrap process succeeds.

Here are examples for the various ways you can connect.

### Connect using key-based authentication

```bash
$ ssh -i ~/.ssh/my.pem root@40.76.28.32
The authenticity of host '40.76.28.32 (40.76.28.32)' can't be established.
RSA key fingerprint is SHA256:YiT1n9QZ64GnXcCeRpYMOLxpJZ9IjCft1Fpf5tvAFuQ.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '40.76.28.32' (RSA) to the list of known hosts.
```

### Connect using a username and password

```bash
$ ssh root@40.76.28.32
The authenticity of host '40.76.28.32 (40.76.28.32)' can't be established.
RSA key fingerprint is SHA256:YiT1n9QZ64GnXcCeRpYMOLxpJZ9IjCft1Fpf5tvAFuQ.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '40.76.28.32' (RSA) to the list of known hosts.
root@40.76.28.32's password:
```

### Connect to a local virtual machine using a forwarded port

Here's an example for Vagrant. The `-l` option specifies the username `vagrant`. The `-p` option specifies the port on the host (2222) that will forward to port 22 on the guest.

```bash
$ ssh -i /home/user/.vagrant/machines/default/virtualbox/private_key -l vagrant -p 2222 localhost
The authenticity of host '[localhost]:2222 ([127.0.0.1]:2222)' can't be established.
RSA key fingerprint is c4:4d:f9:05:09:31:33:05:cd:99:52:5b:fc:e0:10:b5.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[localhost]:2222' (RSA) to the list of known hosts.
Last login: Thu Dec  3 15:32:08 2015 from 10.0.2.2
```

[END_BOX]

[START_BOX]

## 4. Verify network access

[COMMENT] In most cases, you can skip this step. You might want to perform this verification step if your node exists behind your company's firewall or proxy server or if your Red Hat Enterprise Linux or CentOS system comes with preconfigured firewall rules.

For this tutorial, you'll need to ensure that your node can access the Internet and has ports 22 (SSH), 80 (HTTP), and 443 (HTTPS) open to inbound traffic through the firewall.

Although Chef can be run completely from behind the firewall, giving your node Internet access is the easiest way to install packages and perform other common tasks.

In production, you might use automation to bring up servers that have the required network configuration. But for now, let's manually ensure that your server can reach the Internet through your company's firewall. One easy way to test your connection is to run `curl` to retrieve www.cnn.com and search the output for a 200 OK result.

```bash
$ curl -I http://www.cnn.com | grep HTTP/1.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0 88096    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
HTTP/1.1 200 OK
```

If you see 200 OK in the output, you're all set.

If you receive an error like this one, you'll need to configure your firewall.

```bash
$ curl -I http://www.cnn.com | grep HTTP/1.1

curl: (6) Couldn't resolve host 'www.cnn.com'
```

<% accordion('configure-firewall', 'Configure the firewall') do %>

<%= partial 'layouts/partials/configure_iptables' %>

<p/>
If you're still unable to connect, your company's firewall or proxy server might be blocking outbound Internet access. In that case, you may need to work with your network administrator to see what options are available for you to access the Internet from your server.

<% end %>

[END_BOX]

<% if current_page.parent.data.environment == 'aws-automate' %>

[START_BOX]

## 5. Configure data collection

Earlier, you configured Chef server [to send data](/tutorials/manage-a-node/rhel/automate/set-up-your-chef-server#step8) to Chef Automate. Now you'll repeat a simlar process to enable your node to send data. The details of a `chef-client` run is one example of data that nodes can send.

To configure your node to send data, you need:

1. the Chef Automate server's SSL certificate.
1. a configuration file that specifies how to authenticate with Chef Automate, similar to the one you [created for your Chef server](/tutorials/manage-a-node/rhel/automate/set-up-your-chef-server#step8).

### Upload the Chef Automate server's SSL certificate

On Linux nodes, trusted Chef SSL certificates go in the <% fp '/etc/chef/trusted_certs' %> directory. Create that directory now and make it writeable by all users.

```bash
$ sudo mkdir -p /etc/chef/trusted_certs
$ sudo chmod 0777 /etc/chef/trusted_certs
```

Earlier, you [downloaded your Chef Automate server's SSL certificate](/tutorials/manage-a-node/rhel/automate/set-up-your-chef-server#step7) to your workstation. Run `scp` to upload the certificate to your node. Here's an example.

<% command_snippet(page: current_page, path: 'copy-server-certificate/upload-automate-certificate-to-node1-centos', features: [:stdin, :stderr]) %>

### Create the data collection configuration file

To [configure your node to send data](https://docs.chef.io/setup_visibility_chef_automate.html#configure-nodes) to Chef Automate, you can modify your Chef configuration file (typically located at <% fp '/etc/chef/client.rb' %>) or add an additinonal configuration file to the <% fp '/etc/chef/client.d' %> directory.

Because Chef is not yet installed on your node, the configuration file <% fp '/etc/chef/client.rb' %> does not yet exist, so here you'll use the second option.

Start by creating the <% fp '/etc/chef/client.d' %> directory on your node.

```bash
$ sudo mkdir -p /etc/chef/client.d
```

Next, add this to a file named <% fp '/etc/chef/client.d/data_collector.rb' %> on your node. Replace <% ph 'CHEF_AUTOMATE_FQDN' %> with your Chef Automate server's FQDN.

```ruby
# /etc/chef/client.d/data_collector.rb
data_collector.server_url "https://CHEF_AUTOMATE_FQDN/data-collector/v0/"
data_collector.token "93a49a4f2482c64126f7b6015e6b0f30284287ee4054ff8807fb63d9cbd1c506"
```

For example:

```ruby
data_collector.server_url "https://ec2-52-23-164-34.compute-1.amazonaws.com/data-collector/v0/"
data_collector.token "93a49a4f2482c64126f7b6015e6b0f30284287ee4054ff8807fb63d9cbd1c506"
```

As with your Chef server, you can use the token value shown here for learning purposes. In a more production-like envirionment, you can [create your own token](https://docs.chef.io/setup_visibility_chef_automate.html#understand-and-optionally-create-data-collector-tokens).

Your node is now ready to send data to Chef Automate.

[END_BOX]

[START_BOX]

## 6. Close your SSH session

Now close the SSH connection to your Red Hat Enterprise Linux or CentOS node.

```bash
[root@40.76.28.32 ~]$ exit
logout
Connection to 40.76.28.32 closed.
```

[END_BOX]

<% else %>

[START_BOX]

## 5. Close your SSH session

Now close the SSH connection to your Red Hat Enterprise Linux or CentOS node.

```bash
[root@40.76.28.32 ~]$ exit
logout
Connection to 40.76.28.32 closed.
```

[END_BOX]

<% end %>

<% next_page(current_page) do %>

In this part, you brought up a node that you'll configure using Chef.

You also created a test connection to your node over SSH. But once you get the hang of things, you'll see that the bootstrap process enables you to configure your servers without the need to connect to them directly. This enables you to further automate the process of provisioning and configuring your infrastructure.

The next step is to bootstrap your node and run the `learn_chef_httpd` cookbook on it. In [Learn the Chef basics](/tutorials/learn-the-basics/), you ran `chef-client` in local mode to configure the server directly. Now you'll see how the bootstrap process triggers `chef-client` to run on your node remotely, from your workstation.

<% end %>
